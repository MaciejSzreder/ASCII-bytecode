<!DOCTYPE html>
<html>
	<head>
		<title>ASCII bytecode - tests</title>
		<script src="machine.js"></script>
		<script type="module">
			import { expect } from 'https://cdn.jsdelivr.net/npm/chai@5.1.1/+esm';
			
			function testExecutionOutput(code, steps, input, expectedOutput)
			{
				let out = Machine.execute(code, steps, input);

				expect(out).to.deep.equal(expectedOutput)
			}

			testExecutionOutput('o', 1, [], [[0]]);

			testExecutionOutput('io', 2, [[10]], [[10]]);

			testExecutionOutput('io', 15, [[0, 1, 2, 3, 4]], [[0, 1, 2, 3, 4]]);

			testExecutionOutput('iAioao', 14, [[0, 1, 2, 3]], [[1, 0, 3, 2]]);

			// TIS-100: Signal Amplifier
			testExecutionOutput('iA+o', 25, [[0, 1, 2, 3, 4]], [[0, 2, 4, 6, 8]]);
			
			testExecutionOutput('123o', 4, [], [[123]]);
			testExecutionOutput('214o', 4, [], [[214]]);
			testExecutionOutput('156o', 4, [], [[156]]);
			testExecutionOutput('178o', 4, [], [[178]]);
			testExecutionOutput('190o', 4, [], [[190]]);

			testExecutionOutput('190zo', 5, [], [[0]]);

			testExecutionOutput('ioz1HiAzHao', 60, [[0,2,4,6,8],[1,3,5,7,9]], [[0,1,2,3,4,5,6,7,8,9]]);

			testExecutionOutput('1HzhAzHao', 9, [], [[1]]);
		</script>
	</head>
</html>